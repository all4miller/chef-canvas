client_max_body_size 4000M;

server  {
               listen 80;
               server_name <%=node["canvas"]["fqdn"]%> <%=node["canvas"]["files_fqdn"]%>;
               root <%=node["canvas"]["home_dir"]%>/lms/public;
			   charset utf-8;
			   include mime.types;
			   default_type application/octet-stream;
               passenger_enabled on;
               rails_env production;
			   client_max_body_size <%=node["canvas"]["max_body_size"]%>;
        }

# HTTPS server
server  {
               listen 443;
               server_name <%=node["canvas"]["fqdn"]%> <%=node["canvas"]["files_fqdn"]%>;
               root <%=node["canvas"]["home_dir"]%>/lms/public;
			   charset utf-8;
			   include mime.types;
			   default_type application/octet-stream;
               passenger_enabled on;
               rails_env production;
               ssl on;
               ssl_certificate <%=node["canvas"]["ssl_cert"]%>;
               ssl_certificate_key <%=node["canvas"]["ssl_key"]%>;
               ssl_session_timeout  5m;
			   client_max_body_size <%=node["canvas"]["max_body_size"]%>;
        }
